<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>badmoodgame - DEBUGGING</title> <!-- Titel geändert für Klarheit -->

    <!-- Supabase JS Library via CDN (OHNE defer) -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <style>
        /* CSS bleibt wie zuvor - hier gekürzt */
        html { scroll-behavior: smooth; }
        body { background-color: #1a1a1a; color: #e0e0e0; font-family: 'Courier New', Courier, monospace; margin: 0; padding: 0; line-height: 1.7; background-image: linear-gradient(rgba(0,0,0,0.05) 1px, transparent 1px), linear-gradient(90deg, rgba(0,0,0,0.05) 1px, transparent 1px); background-size: 3px 3px; }
        #login-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.85); z-index: 1000; display: none; /* WICHTIG: Startet versteckt */ align-items: center; justify-content: center; border: 2px solid red; /* Roter Rand zum Testen */ }
        .login-box { background-color: #222; padding: 30px 40px; border-radius: 25px; border: 1px solid #555; text-align: center; max-width: 400px; width: 90%; box-shadow: 0 5px 25px rgba(0,0,0,0.4); }
        .login-box h2 { margin-top: 0; margin-bottom: 20px; color: #fff; font-size: 1.5em; }
        #main-content { display: none; border: 2px solid blue; /* Blauer Rand zum Testen */} /* Versteckt erstmal ALLES andere */
         /* --- Restliches CSS wie zuvor --- */
    </style>
</head>
<body>

    <!-- Login Modal (Minimaler Inhalt zum Testen) -->
    <div id="login-modal">
        <div class="login-box">
             <h2>Login Modal (Test)</h2>
             <p style="color: lightgreen;">Wenn du das siehst, funktioniert das Anzeigen!</p>
             <div id="init-status">Initialisierungsstatus: Warte...</div>
        </div>
    </div>

    <!-- Hauptinhalt der Seite (bleibt erstmal versteckt) -->
    <div id="main-content" style="display: none;">
       <p>Dies ist der Hauptinhalt (sollte versteckt sein).</p>
       <!-- ... Restlicher HTML-Inhalt hier ... -->
    </div>

    <script>
        console.log("DEBUG: SCRIPT START");

        // --- SUPABASE INITIALISIERUNG ---
        const SUPABASE_URL = "https://baifviqcjqmdtmjlseun.supabase.co";
        const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJhaWZ2aXFjanFtZHRtamxzZXVuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDYyOTE4MTksImV4cCI6MjA2MTg2NzgxOX0.-zoFCE57MZcTynDVQlsT5K4viVRf0HBtjctNoBH64GA";
        let supabase = null;
        let initError = null;
        let initStatusDiv = null; // Referenz für Statusanzeige

        try {
            // Sicherstellen, dass window.supabase existiert, bevor wir es aufrufen
            if (window.supabase && typeof window.supabase.createClient === 'function') {
                supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                console.log('DEBUG: Supabase Client Objekt erstellt.');
                 // Status im Modal aktualisieren (wenn Modal schon gefunden wurde)
                 initStatusDiv = document.getElementById('init-status');
                 if(initStatusDiv) initStatusDiv.textContent = "Supabase Client OK.";
                 else console.warn("DEBUG: init-status div noch nicht gefunden bei Supabase Init.");

            } else {
                throw new Error('Supabase Client Library (window.supabase) fehlt oder ist fehlerhaft.');
            }
        } catch (error) {
            console.error('DEBUG: FATAL Fehler bei Supabase Initialisierung:', error);
            initError = error;
             // Versuche Fehler im Modal anzuzeigen
             try {
                 let modalBox = document.querySelector('#login-modal .login-box');
                 if (modalBox) {
                     modalBox.innerHTML = `<h2 style='color:red'>FATAL ERROR</h2><p style='color:red'>${error.message}</p>`;
                     let modal = document.getElementById('login-modal');
                     if(modal) modal.style.display = 'flex'; // Zeige Modal mit Fehler
                 } else {
                      document.body.innerHTML = `<div style="color:red; padding:20px;">FATAL ERROR: ${error.message} (Konnte Modal nicht finden)</div>`;
                 }
             } catch(e) { /* Ignoriere Fehler beim Fehler anzeigen */ }
        }

        // --- Minimaler Code zum Anzeigen des Modals nach DOM Ready ---
        function showMinimalUI() {
             console.log("DEBUG: showMinimalUI wird aufgerufen.");
             const loginModalElement = document.getElementById('login-modal');
             const statusDiv = document.getElementById('init-status'); // Erneut holen für Sicherheit

             if(statusDiv) { // Update Statusanzeige
                 statusDiv.textContent = initError ? `Fehler: ${initError.message}` : "Supabase OK. Versuche Modal anzuzeigen...";
                 if(initError) statusDiv.style.color = 'red';
             } else {
                  console.warn("DEBUG: Status Div ('init-status') nicht gefunden in showMinimalUI.");
             }

             if (loginModalElement) {
                 console.log("DEBUG: loginModal Element gefunden. Setze display auf 'flex'.");
                 try {
                    loginModalElement.style.display = 'flex'; // Versuche, das Modal sichtbar zu machen
                    console.log("DEBUG: loginModal.style.display sollte jetzt 'flex' sein.");

                    // Überprüfe den berechneten Stil (was der Browser *wirklich* anzeigt)
                    const computedStyle = window.getComputedStyle(loginModalElement);
                    console.log("DEBUG: Berechneter display Stil für loginModal:", computedStyle.display);
                    if (computedStyle.display !== 'flex') {
                         console.error("DEBUG: PROBLEM! display ist NICHT flex, obwohl gesetzt. CSS-Konflikt?");
                    }

                 } catch (e) {
                      console.error("DEBUG: Fehler beim Setzen von display für loginModal:", e);
                      if(statusDiv) statusDiv.textContent = `Fehler beim Anzeigen des Modals: ${e.message}`;
                 }
             } else {
                 console.error("DEBUG: FEHLER! loginModal Element wurde NICHT gefunden!");
                 // Zeige Fehler direkt im Body, da Modal fehlt
                 document.body.innerHTML = `<div style="color:red; padding:20px;">FEHLER: HTML Element mit ID 'login-modal' fehlt!</div>`;
             }
        }

        // --- DOMContentLoaded Listener ---
        if (document.readyState === 'loading') {
             console.log("DEBUG: Warte auf DOMContentLoaded...");
             document.addEventListener('DOMContentLoaded', showMinimalUI);
        } else {
             console.log("DEBUG: DOM bereit, rufe showMinimalUI direkt.");
             showMinimalUI();
        }

        console.log("DEBUG: SCRIPT END");

        // ===============================================
        // ===     ALLER ANDERER CODE AUSKOMMENTIERT   ===
        // ===============================================
        /*
        let loginBox, mainContent, usernameDisplay, rankDisplayElement, logoutButton, //... etc

        function assignDomElements() { ... }
        function showLoginForm(...) { ... }
        function showRegisterForm(...) { ... }
        function showForgotPasswordForm(...) { ... }
        function showUpdatePasswordForm(...) { ... }
        function showConfirmationMessage(...) { ... }
        async function handleLogin(...) { ... }
        async function handleRegister(...) { ... }
        async function handleForgotPassword(...) { ... }
        async function handleUpdatePassword(...) { ... }
        async function handleResendConfirmation(...) { ... }
        async function handleLogout(...) { ... }
        function handleAuthFormSubmit(...) { ... }
        function handleAuthLinkClick(...) { ... }
        function initializeApp() { ... } // Komplett auskommentiert!
        async function fetchSolutions() { ... }
        async function fetchRankings() { ... }
        function renderRankings(...) { ... }
        async function handleProblemSubmit(...) { ... }
        const questions = [ ... ];
        function startQuiz() { ... }
        // ... etc ...
        */

    </script>

</body>
</html>