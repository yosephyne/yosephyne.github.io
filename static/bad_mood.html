<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>badmoodgame - Minimal Test</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        /* === Minimales CSS === */
        body { background-color: #1a1a1a; color: #e0e0e0; font-family: 'Courier New', Courier, monospace; margin: 0; padding: 20px; }
        #main-content { display: none; border: 1px dotted blue; padding: 10px; }
        #login-modal { display: none; /* Startet versteckt */ position: fixed; top:0; left:0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.8); align-items: center; justify-content: center; z-index: 1000; }
        .login-box { background-color: #222; padding: 20px; border-radius: 10px; border: 1px solid #555; text-align: center; }
        .login-box h2 { color: white; }
        .login-box label { display: block; color: #ccc; margin-top: 10px; }
        .login-box input { background: #444; color: white; border: 1px solid #666; padding: 5px; margin-bottom: 10px; }
        .login-box button { padding: 8px 15px; margin-top: 10px; cursor: pointer; }
        .auth-switch a, .forgot-password-link a { color: lightblue; cursor: pointer; font-size: 0.9em; margin: 0 5px; }
    </style>
</head>
<body>

    <div id="login-modal">
        <div class="login-box">
             <h2>Login (Minimal Test)</h2>
             <form id="test-login-form" onsubmit="event.preventDefault(); console.log('Test Form Submit');">
                 <label for="test-email">Email:</label>
                 <input type="email" id="test-email">
                 <label for="test-pw">Passwort:</label>
                 <input type="password" id="test-pw">
                 <button type="submit">Test Login</button>
             </form>
             <div class="forgot-password-link"><a onclick="console.log('Test Klick: PW Vergessen')">PW vergessen?</a></div>
             <div class="auth-switch"><a onclick="console.log('Test Klick: Registrieren')">Registrieren</a></div>
        </div>
    </div>

    <div id="main-content">
        <h1>Hauptinhalt (Sollte versteckt sein)</h1>
        <button id="test-logout-button" onclick="console.log('Test Klick: Logout')">Test Logout</button>
    </div>

    <script>
        console.log("SCRIPT START (Minimal)");

        // --- SUPABASE INITIALISIERUNG ---
        const SUPABASE_URL = "https://baifviqcjqmdtmjlseun.supabase.co";
        const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJhaWZ2aXFjanFtZHRtamxzZXVuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDYyOTE4MTksImV4cCI6MjA2MTg2NzgxOX0.-zoFCE57MZcTynDVQlsT5K4viVRf0HBtjctNoBH64GA";
        let supabase = null;
        let initError = null;

        try {
            if (window.supabase?.createClient) {
                supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                console.log('Supabase Client OK.');
            } else { throw new Error('Supabase Library fehlt.'); }
        } catch (error) { console.error('FATAL: Supabase Init Fehler:', error); initError = error; }

        // --- DOM ELEMENT REFERENZEN ---
        let loginModal; // Nur das NÃ¶tigste

        // --- Kernfunktion zum Anzeigen des Modals ---
        function showTheLoginModal() {
            console.log("Versuche Login Modal anzuzeigen...");
            loginModal = document.getElementById('login-modal'); // Hole Element direkt hier
            if (loginModal) {
                 console.log("  -> loginModal gefunden.");
                 try {
                     loginModal.style.display = 'flex'; // Direkt anzeigen
                     console.log("  -> loginModal display=flex gesetzt.");
                 } catch (e) {
                     console.error("  -> FEHLER beim Setzen von display:", e);
                     document.body.innerHTML = `<div style='color:red;padding:20px;'>Fehler beim Anzeigen des Login Modals: ${e.message}</div>`;
                 }
            } else {
                console.error("FEHLER: #login-modal Element NICHT im DOM gefunden!");
                document.body.innerHTML = `<div style='color:red;padding:20px;'>FEHLER: HTML Element #login-modal fehlt!</div>`;
            }
        }

        // --- Start der UI-Logik nach DOMContentLoaded ---
        function startUI() {
             console.log("startUI: Wird nach DOMContentLoaded aufgerufen.");
             if (initError) {
                 document.body.innerHTML = `<div style='color:red;padding:20px;'>FATAL ERROR: Supabase konnte nicht initialisiert werden. ${initError.message}</div>`;
                 return; // Abbruch
             }
             // Zeige IMMER das Login Modal in diesem Test
             showTheLoginModal();

             // === ALTE AUTH LOGIK AUSKOMMENTIERT ===
             /*
             if (!assignCoreDomElements()) { return; }
             if (loginBox) { ... listener ... } else { return; }
             if (logoutButton) { ... listener ... }
             if (supabase) { supabase.auth.onAuthStateChange(...) }
             */
             console.log("startUI: Minimal-Anzeige abgeschlossen.");
         }

        // --- START DER ANWENDUNG ---
        if (document.readyState === 'loading') {
             console.log("Warte auf DOMContentLoaded...");
             document.addEventListener('DOMContentLoaded', startUI);
        } else {
             console.log("DOM bereit, rufe startUI direkt.");
             startUI();
        }
        console.log("SCRIPT END (Minimal)");
    </script>

</body>
</html>